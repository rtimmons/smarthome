import "../tools/just/nvm.just"

set shell := ["bash", "-lc"]
config_env := "XDG_CONFIG_HOME=$PWD/.config"
no_update := "NO_UPDATE_NOTIFIER=1"

setup:
	{{nvm_use}}; \
	cd ExpressServer && npm install

test:
	{{nvm_use}}; \
	cd ExpressServer && mkdir -p .config && {{no_update}} {{config_env}} npm test && {{no_update}} {{config_env}} npm run check

ha-addon:
	python ../tools/addon_builder.py build grid-dashboard

deploy:
	python ../tools/addon_builder.py deploy grid-dashboard

report:
	set -e
	scripts/collect_report.sh
