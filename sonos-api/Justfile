import "../talos/just/nvm.just"

set shell := ["bash", "-lc"]

setup:
	{{nvm_use}}; \
	npm install

test:
	{{nvm_use}}; \
	npm run build

ha-addon:
	if [ ! -x "../talos/build/bin/talos" ]; then ../talos/build.sh; fi
	../talos/build/bin/talos addon build sonos-api

container-test:
	@echo "==> Container test: sonos-api uses Home Assistant's container build system"
	@echo "==> Verifying add-on build completes successfully..."
	if [ ! -x "../talos/build/bin/talos" ]; then ../talos/build.sh; fi
	../talos/build/bin/talos addon build sonos-api
	@echo "==> Add-on build test passed - ready for deployment"

deploy:
	if [ ! -x "../talos/build/bin/talos" ]; then ../talos/build.sh; fi
	../talos/build/bin/talos addon deploy sonos-api
